12/16/2019 20:04:39 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
12/16/2019 20:04:39 - WARNING - root -   NUM LABELS: 3
12/16/2019 20:04:39 - WARNING - root -   <class 'transformers.configuration_roberta.RobertaConfig'>
12/16/2019 20:04:39 - INFO - transformers.configuration_utils -   loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-config.json from cache at /home/ijon/.cache/torch/transformers/c22e0b5bbb7c0cb93a87a2ae01263ae715b4c18d692b1740ce72cacaa99ad184.233bd69ec613d2ebcb1d55823dfc5b1e109157918e13bdbde6db7f694e1a0039
12/16/2019 20:04:39 - INFO - transformers.configuration_utils -   Model config {
  "attention_probs_dropout_prob": 0.1,
  "finetuning_task": "task4b",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 1024,
  "initializer_range": 0.02,
  "intermediate_size": 4096,
  "is_decoder": false,
  "layer_norm_eps": 1e-05,
  "max_position_embeddings": 514,
  "num_attention_heads": 16,
  "num_hidden_layers": 24,
  "num_labels": 3,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pruned_heads": {},
  "torchscript": false,
  "type_vocab_size": 1,
  "use_bfloat16": false,
  "vocab_size": 50265
}

12/16/2019 20:04:40 - INFO - transformers.tokenization_utils -   loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-vocab.json from cache at /home/ijon/.cache/torch/transformers/1ae1f5b6e2b22b25ccc04c000bb79ca847aa226d0761536b011cf7e5868f0655.ef00af9e673c7160b4d41cfda1f48c5f4cba57d5142754525572a846a1ab1b9b
12/16/2019 20:04:40 - INFO - transformers.tokenization_utils -   loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-merges.txt from cache at /home/ijon/.cache/torch/transformers/f8f83199a6270d582d6245dc100e99c4155de81c9745c6248077018fe01abcfb.70bec105b4158ed9a1747fea67a43f5dee97855c64d62b6ec3742f4cfdb5feda
12/16/2019 20:04:41 - INFO - transformers.modeling_utils -   loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-pytorch_model.bin from cache at /home/ijon/.cache/torch/transformers/195c00f28dc68ef13a307c6db84d566f801f03b2b6bcf8b29524f10f767fac2a.fc7abf72755ecc4a75d0d336a93c1c63358d2334f5998ed326f3b0da380bf536
12/16/2019 20:04:51 - INFO - transformers.modeling_utils -   Weights of RobertaForMultipleChoice not initialized from pretrained model: ['classifier.weight', 'classifier.bias']
12/16/2019 20:04:51 - INFO - transformers.modeling_utils -   Weights from pretrained model not used in RobertaForMultipleChoice: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.weight']
12/16/2019 20:04:55 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='', config_name='', data_dir='/mnt/minerva1/nlp/projects/counterfactual/semeval/4/data/', device=device(type='cuda'), do_eval=True, do_lower_case=False, do_test=False, do_train=True, eval_all_checkpoints=True, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=5, learning_rate=2e-06, local_rank=-1, logging_steps=50, max_grad_norm=1.0, max_seq_length=80, max_steps=-1, model_name_or_path='roberta-large', model_type='roberta', n_gpu=1, no_cuda=False, num_train_epochs=25.0, output_dir='models_roberta-large_task4b/roberta-large', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=16, per_gpu_train_batch_size=16, save_steps=50, seed=42, server_ip='', server_port='', task_name='task4b', tokenizer_name='', warmup_steps=0, weight_decay=0.0)
12/16/2019 20:04:55 - INFO - __main__ -   Loading features from cached file /mnt/minerva1/nlp/projects/counterfactual/semeval/4/data/cached_train_roberta-large_80_task4b
12/16/2019 20:04:55 - WARNING - root -   All label ids:
12/16/2019 20:04:55 - WARNING - root -   tensor([0, 1, 0,  ..., 0, 2, 2])
12/16/2019 20:04:55 - INFO - __main__ -   ***** Running training *****
12/16/2019 20:04:55 - INFO - __main__ -     Num examples = 9002
12/16/2019 20:04:55 - INFO - __main__ -     Num Epochs = 25
12/16/2019 20:04:55 - INFO - __main__ -     Instantaneous batch size per GPU = 16
12/16/2019 20:04:55 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 80
12/16/2019 20:04:55 - INFO - __main__ -     Gradient Accumulation steps = 5
12/16/2019 20:04:55 - INFO - __main__ -     Total optimization steps = 2800
Iteration:   0%|          | 0/563 [00:00<?, ?it/s]
Epoch:   0%|          | 0/25 [00:00<?, ?it/s][A

Iteration:   0%|          | 0/563 [00:00<?, ?it/s][A[A

                                                  [A[A
                                             [AIteration:   0%|          | 0/563 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "./examples/run_semeval_task4b.py", line 597, in <module>
    main()
  File "./examples/run_semeval_task4b.py", line 528, in main
    global_step, tr_loss, best_steps = train(args, train_dataset, model, tokenizer)
  File "./examples/run_semeval_task4b.py", line 163, in train
    outputs = model(**inputs)
  File "/home/ijon/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 547, in __call__
    result = self.forward(*input, **kwargs)
  File "/mnt/minerva1/nlp/projects/counterfactual/semeval/5/transformers/transformers/modeling_roberta.py", line 447, in forward
    attention_mask=flat_attention_mask, head_mask=head_mask)
  File "/home/ijon/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 547, in __call__
    result = self.forward(*input, **kwargs)
  File "/mnt/minerva1/nlp/projects/counterfactual/semeval/5/transformers/transformers/modeling_bert.py", line 731, in forward
    encoder_attention_mask=encoder_extended_attention_mask)
  File "/home/ijon/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 547, in __call__
    result = self.forward(*input, **kwargs)
  File "/mnt/minerva1/nlp/projects/counterfactual/semeval/5/transformers/transformers/modeling_bert.py", line 380, in forward
    layer_outputs = layer_module(hidden_states, attention_mask, head_mask[i], encoder_hidden_states, encoder_attention_mask)
  File "/home/ijon/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 547, in __call__
    result = self.forward(*input, **kwargs)
  File "/mnt/minerva1/nlp/projects/counterfactual/semeval/5/transformers/transformers/modeling_bert.py", line 351, in forward
    self_attention_outputs = self.attention(hidden_states, attention_mask, head_mask)
  File "/home/ijon/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 547, in __call__
    result = self.forward(*input, **kwargs)
  File "/mnt/minerva1/nlp/projects/counterfactual/semeval/5/transformers/transformers/modeling_bert.py", line 305, in forward
    self_outputs = self.self(hidden_states, attention_mask, head_mask, encoder_hidden_states, encoder_attention_mask)
  File "/home/ijon/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 547, in __call__
    result = self.forward(*input, **kwargs)
  File "/mnt/minerva1/nlp/projects/counterfactual/semeval/5/transformers/transformers/modeling_bert.py", line 244, in forward
    attention_probs = self.dropout(attention_probs)
  File "/home/ijon/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 547, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/ijon/.local/lib/python3.6/site-packages/torch/nn/modules/dropout.py", line 54, in forward
    return F.dropout(input, self.p, self.training, self.inplace)
  File "/home/ijon/.local/lib/python3.6/site-packages/torch/nn/functional.py", line 806, in dropout
    else _VF.dropout(input, p, training))
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 10.76 GiB total capacity; 9.67 GiB already allocated; 18.25 MiB free; 134.25 MiB cached)
Iteration:   0%|          | 0/563 [00:00<?, ?it/s]
Epoch:   0%|          | 0/25 [00:00<?, ?it/s]